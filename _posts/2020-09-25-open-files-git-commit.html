---
layout: post
title: Shell script to open all them all (files)
---
<html>
<head>
<link href="/assets/main.css" rel="stylesheet" />
</head>
<body>
  <p>This is a small shell script that I use to open all files related to a commit in git; I find it quite useful when I want to resume working on a local branch.</p>

  <div>
    <pre class="code">
#!/bin/bash
gitPrefix=$(git rev-parse --show-toplevel)

__num=$(git diff --name-only | wc -l)

filter_open() {
    $1 | perl -p -e 's!.+!'$gitPrefix'/$&!; s!.+(png|jpeg)$!!' | xargs kate -n > /dev/null 2>&1 &
}

if [ -z "$1" -a "$__num" -ge 1 ]; then
    filter_open "git diff --name-only"
else
    filter_open "git diff HEAD^1 --name-only"
fi
    </pre>
  </div>

  <p><code>git rev-parse --show-toplevel</code>: returns the absolute path to the topelevel git repo dir</p>
  <p><code>git diff --name-only</code>: returns the list of the files that are changed but not commited yet</p>
  <p><code>git diff HEAD^1 --name-only</code>: returns the list of files that were changed (committed or not) since the commit before last in the repo</p>
  <p><code>perl -p -e 's!.+!'$gitPrefix'/$&!; s!.+(png|jpeg)$!!'</code>: this prepends $gitPrefix to all the relative file paths that the from git diff commands; also it filters out all png/jpeg files (I don't want to edit images with a text editor... it doesn't work)</p>

  <p>As you can see, I write hacky bash scripts, I am sure there are ways to make it more elegant, but it works, so.</p>

  <p>I have two use cases here:
    <li>I started working in a branch, and haven't committed anything yet, so to reopen all the files I've changed in kate, I use the script without any arguments</li>
    <li>I started working on a branch, committed some stuff, and also have some work-in-progress that hasn't been committed yet, if I want to open all files (those that have been committed in the last commit and those that are still not committed), I call the script with <i>any</i> argument e.g. <code>all</code>.</li>
  </p>

  <p>Bonus point, if you save the script as e.g. <code>git-open-files</code> somewhere in your PATH, you can call the script directly (after making it executable) from terminal or you can use it as a git command <code>git open-files</code>.</p>

  <p>Happy hacking!</p>

</body>
</html>